rm(list=ls())
library(foreign)
library(survey)
natsal2 <- read.dta('~/Documents/M_Genitalium/Natsal-2 data/stata11/natsal_2000_for_archive.dta')
natsal2$newnocon <- natsal2$nonocon
table(natsal2$r1datef)
table(cut(natsal2$r1datef, breaks=c(-0.5, 1000))
)
table(cut(natsal2$r1datef, breaks=c(-1.5,-0.5, 1000, 10000))
)
natsal2$r1datef_known <- factor(cut(natsal2$r1datef, breaks=c(-1.5,-0.5, 1000, 10000)), levels=c('no','yes','no'))
natsal2$r1datef_known <- factor(cut(natsal2$r1datef, breaks=c(-1.5,-0.5, 1000, 10000)), levels=c('n/a','yes','no'))
# make a new variable to try to get at no. new parters without a condom
natsal2$newnocon <- natsal2$nonocon
natsal2$r1datef_known <- factor(
cut(natsal2$r1datef, breaks=c(-1.5,-0.5, 1000, 10000)),
levels=c('n/a','yes','no')
)
table(natsal2$nonocon, natsal2$r1datef_known)
table(natsal2$nonocon, natsal2$r1datef_known, useNA='ifany')
# make a new variable to try to get at no. new parters without a condom
natsal2$newnocon <- natsal2$nonocon
natsal2$r1datef_known <- factor(
cut(natsal2$r1datef, breaks=c(-1.5,-0.5, 1000, 10000)),
labels=c('n/a','yes','no')
)
table(natsal2$nonocon, natsal2$r1datef_known, useNA='ifany')
natsal2$newnocon[(natsal2$r1datef_known == 'yes') & (natsal2$r1datef_known <= 12 )] <-
natsal2$newnocon[(natsal2$r1datef_known == 'yes') & (natsal2$r1datef_known <= 12 )] - 1
natsal2$newnocon[(natsal2$r1datef_known == 'yes') & (natsal2$r1datef <= 12 )] <-
natsal2$newnocon[(natsal2$r1datef_known == 'yes') & (natsal2$r1datef <= 12 )] - 1
table(natsal2$nonocon, natsal2$nonewcon)
table(natsal2$nonocon, natsal2$newnocon)
# make a new variable to try to get at no. new parters without a condom
natsal2$newnocon <- natsal2$nonocon
natsal2$r1datef_known <- factor(
cut(natsal2$r1datef, breaks=c(-1.5,-0.5, 1000, 10000)),
labels=c('n/a','yes','no')
)
natsal2$newnocon[(natsal2$r1datef_known == 'yes') & (natsal2$r1datef <= 12 )] <-
natsal2$newnocon[(natsal2$r1datef_known == 'yes') & (natsal2$r1datef <= 12 )] - 1
table(natsal2$c_result, natsal2$nonocon, natsal2$rsex, natsal2$agrp, useNA='ifany')
# make a new variable to try to get at no. new parters without a condom
natsal2$newnocon <- natsal2$nonocon
natsal2$r1datef_known <- factor(
cut(natsal2$r1datef, breaks=c(-1.5,-0.5, 1000, 10000)),
labels=c('n/a','yes','no')
)
natsal2$newnocon[(natsal2$r1datef_known == 'yes') & (natsal2$r1datef > 12 )] <-
natsal2$newnocon[(natsal2$r1datef_known == 'yes') & (natsal2$r1datef > 12 )] - 1
table(natsal2$c_result, natsal2$nonocon, natsal2$rsex, natsal2$agrp, useNA='ifany')
table(natsal2$c_result, natsal2$newnocon, natsal2$rsex, natsal2$agrp, useNA='ifany')
plot(seq(0,1,0.01), dbeta(seq(0,1,0.01), 10, 10))
plot(seq(0,1,0.01), dbeta(seq(0,1,0.01), 10, 1))
plot(seq(0,1,0.01), dbeta(seq(0,1,0.01), 10, 1))
plot(seq(0,1,0.01), dbeta(seq(0,1,0.01), 10, 1))
plot(seq(0,1,0.01), dbeta(seq(0,1,0.01), 10, 1))
qbeta(0.5, 1, 1)
qbeta(0.5, 10, 1)
qbeta(0.025, 10, 1)
qbeta(0.975, 10, 1)
qbeta(0.5, 1, 10)
plot(seq(0,1,0.01), dbeta(seq(0,1,0.01), 1, 10))
qbeta(0.025, 1, 10)
qbeta(0.975, 1, 10)
devtools::install_github("mrc-ide/odin", upgrade = FALSE)
lorenz <- odin::odin({
## Derivatives
deriv(y1) <- sigma * (y2 - y1)
deriv(y2) <- R * y1 - y2 - y1 * y3
deriv(y3) <- -b * y3 + y1 * y2
## Initial conditions
initial(y1) <- 10.0
initial(y2) <- 1.0
initial(y3) <- 1.0
## parameters
sigma <- 10.0
R     <- 28.0
b     <-  8.0 / 3.0
config(base) <- "lorenz"
}, path)
lorenz <- odin::odin({
## Derivatives
deriv(y1) <- sigma * (y2 - y1)
deriv(y2) <- R * y1 - y2 - y1 * y3
deriv(y3) <- -b * y3 + y1 * y2
## Initial conditions
initial(y1) <- 10.0
initial(y2) <- 1.0
initial(y3) <- 1.0
## parameters
sigma <- 10.0
R     <- 28.0
b     <-  8.0 / 3.0
config(base) <- "lorenz"
} )
lorenz
y <- lorenz$run(t)
y <- (lorenz())$run(t)
t
t <- seq(0, 10, length.out = 101)
t
y <- (lorenz())$run(t)
y
plot(y, xlab = "Time", ylab = "y", main = "", las = 1)
config(base) <- "model1"
config(base) <- "lorenz"
source('~/Documents/teaching_etc/StochPractical2018/odin_lorenz.R')
model1 <- odin::odin({
## Derivatives
deriv(N_ODE) <- r*N_ODE
## Initial conditions
initial(N_ODE) <- N0
## parameters
r <- 0.5 # Growth rate/week
N0 <- 5 #	Initial number
config(base) <- "model1"
} )
source('~/Documents/teaching_etc/StochPractical2018/model1_single_stochastic_growth.R')
source('~/Documents/teaching_etc/StochPractical2018/model1_single_stochastic_growth.R')
source('~/Documents/teaching_etc/StochPractical2018/model1_single_stochastic_growth.R')
N_ODE <- (model2())$run(t)
source('~/Documents/teaching_etc/StochPractical2018/model2_stochastic_growth.R')
source('~/Documents/teaching_etc/StochPractical2018/model2_stochastic_growth.R')
N_ODE <- (model3())$run(t)
source('~/Documents/teaching_etc/StochPractical2018/model3_stochastic_growth_and_death.R')
devtools::install_github("mrc-ide/odin", upgrade = FALSE)
vignette()
vignette(, package="odin")
setwd('/Users/Joanna/Documents/teaching_etc/StochPractical2018/stochasticity-practical/EXAMPLE1')
shiny::runApp()
devtools::install_github("mrc-ide/odin.ui@prototype")
shiny::runApp()
